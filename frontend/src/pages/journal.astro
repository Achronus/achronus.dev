---
import Layout from "@/layouts/BaseLayout.astro";

import { ArticleSection } from "@/components/Portfolio";
import type { Project, SocialIcon } from "@/types/collections";
import { formatArticleCollection } from "@/utils";

import { getCollection } from "astro:content";

const projectCollection: any[] = await getCollection("projects");
const articleCollection: any[] = await getCollection("articles");
const socialCollection: any[] = await getCollection("socials");

const articles = formatArticleCollection(articleCollection);
const projects: Project[] = projectCollection.map((project) => ({
  slug: project.data.slug,
  title: project.data.title,
  description: project.body,
  url: project.data.url,
  order: project.data.order,
}));
const socialIcons: SocialIcon[] = socialCollection.map((icon) => icon.data);
---

<Layout
  title="Project Journal"
  socials={socialIcons.sort((a, b) => a.order - b.order)}
>
  <ArticleSection
    categories={projects.sort((a, b) => a.order - b.order)}
    articles={articles}
    client:load
  />
</Layout>
